<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title><%= movie.title %></title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.6/dist/css/bootstrap.min.css" rel="stylesheet">
  <script src="https://kit.fontawesome.com/fc20eca1ac.js" crossorigin="anonymous"></script>
  <link rel="stylesheet" href="/css/main.css">
</head>
<body>
  <%- include("partials/navbar.ejs") %>

  <div class="container py-5">
    <div class="row align-items-center">
      <!-- Image on the left -->
      <div class="col-md-5 text-center mb-4 mb-md-0">
        <img src="https://image.tmdb.org/t/p/w500<%= movie.backdrop_path %>" class="img-fluid rounded shadow" alt="<%= movie.title %>">
      </div>

      <!-- Movie Details on the right -->
      <div class="col-md-7">
        <h2><%= movie.title %></h2>

        <p class="w-75"><strong>Overview:</strong> <%= movie.overview %></p>

        <% if (movie.vote_average >= 0.0 && movie.vote_average <= 1.0) { %>
          <p class="mb-0 mt-3">
            <strong>Average Rating:</strong>
            <i class="fa-solid fa-star-half-stroke" style="color: #FFD43B;"></i>
          </p>
        <% } %>

        <% if (movie.vote_average >= 1.0 && movie.vote_average <= 1.9) { %>
          <p class="mb-0 mt-3">
            <strong>Average Rating:</strong>
            <i class="fa-solid fa-star" style="color: #FFD43B;"></i>
          </p>
        <% } %>

        <% if (movie.vote_average >= 2.0 && movie.vote_average <= 2.4) { %>
          <p class="mb-0 mt-3">
            <strong>Average Rating:</strong>
            <small class="text-secondary">Average Rating:</small>
            <i class="fa-solid fa-star" style="color: #FFD43B;"></i>
            <i class="fa-solid fa-star-half-stroke" style="color: #FFD43B;"></i> 
          </p>
        <% } %>

        <% if (movie.vote_average >= 2.5 && movie.vote_average <= 2.9) { %>
          <p class="mb-0 mt-3">
            <strong>Average Rating:</strong>
              <i class="fa-solid fa-star" style="color: #FFD43B;"></i>
              <i class="fa-solid fa-star" style="color: #FFD43B;"></i>
          </p>
        <% } %>


        <% if (movie.vote_average >= 3.0 && movie.vote_average <= 3.4) { %>
          <p class="mb-0 mt-3">
            <strong>Average Rating:</strong>
              <i class="fa-solid fa-star" style="color: #FFD43B;"></i>
              <i class="fa-solid fa-star-half-stroke" style="color: #FFD43B;"></i>
          </p>
        <% } %>

        <% if (movie.vote_average >= 3.5 && movie.vote_average <= 3.9) { %>
          <p class="mb-0 mt-3">
            <strong>Average Rating:</strong>
            <i class="fa-solid fa-star" style="color: #FFD43B;"></i>
            <i class="fa-solid fa-star" style="color: #FFD43B;"></i>
            <i class="fa-solid fa-star" style="color: #FFD43B;"></i>
          </p>
        <% } %>

        <% if (movie.vote_average >= 4.0 && movie.vote_average <= 4.4) { %>
          <p class="mb-0 mt-3">
            <strong>Average Rating:</strong>
            <i class="fa-solid fa-star" style="color: #FFD43B;"></i>
            <i class="fa-solid fa-star" style="color: #FFD43B;"></i>
            <i class="fa-solid fa-star" style="color: #FFD43B;"></i>
            <i class="fa-solid fa-star-half-stroke" style="color: #FFD43B;"></i>
          </p>
        <% } %>

        <% if (movie.vote_average >= 4.5 && movie.vote_average <= 4.9) { %>
          <p class="mb-0 mt-3">
            <strong>Average Rating:</strong>
            <i class="fa-solid fa-star" style="color: #FFD43B;"></i>
            <i class="fa-solid fa-star" style="color: #FFD43B;"></i>
            <i class="fa-solid fa-star" style="color: #FFD43B;"></i>
            <i class="fa-solid fa-star" style="color: #FFD43B;"></i>
          </p>
        <% } %>

        <% if( movie.vote_average >= 5.0) { %>
          <p class="mb-0 mt-3">
            <strong>Average Rating:</strong>
            <i class="fa-solid fa-star" style="color: #FFD43B;"></i>
            <i class="fa-solid fa-star" style="color: #FFD43B;"></i>
            <i class="fa-solid fa-star" style="color: #FFD43B;"></i>
            <i class="fa-solid fa-star" style="color: #FFD43B;"></i>
            <i class="fa-solid fa-star" style="color: #FFD43B;"></i>
          </p>
        <% } %>

        <p><strong>Release Date:</strong> <%= movie.release_date %></p>

        <a href="javascript:history.back()" class="btn btn-secondary mt-3">Back</a>
      </div>
    </div>
  </div>

  <% if (recMovies) { %>
      <div class="container mt-5 pt-5">
        <h2 class="mb-4 d-inline-block border-bottom border-primary border-3">Related Movies</h2>
        <div class="row">
          <% recMovies.forEach(recMovie => { %>
              <div class="col-lg-3 mb-4">
                <div class="card h-100">
                  <img src="https://image.tmdb.org/t/p/w500<%= recMovie.backdrop_path || '' %>" class="card-img-top" style="object-fit: cover; height: 180px;">
                  <div class="card-body d-flex flex-column">
                    <a href="/movie/<%= recMovie.id %>" class="text-dark">
                      <h5 class="card-title"><%= recMovie.title.length > 60 ? recMovie.title.substring(0, 57) + "..." : recMovie.title %></h5>
                    </a>
                    <p class="card-text"><%= movie.overview ? (recMovie.overview.length > 80 ? recMovie.overview.substring(0, 77) + "..." : recMovie.overview) : "No Description" %></p>
                    <% if (recMovie.vote_average >= 0.0 && recMovie.vote_average <= 1.0) { %>
                      <p class="mb-0 mt-3">
                        <small class="text-secondary">Average Rating:</small>
                        <i class="fa-solid fa-star-half-stroke" style="color: #FFD43B;"></i>
                      </p>
                    <% } %>

                    <% if (recMovie.vote_average >= 1.0 && recMovie.vote_average <= 1.9) { %>
                      <p class="mb-0 mt-3">
                        <small class="text-secondary">Average Rating:</small>
                        <i class="fa-solid fa-star" style="color: #FFD43B;"></i>
                      </p>
                    <% } %>

                    <% if (recMovie.vote_average >= 2.0 && recMovie.vote_average <= 2.4) { %>
                      <p class="mb-0 mt-3">
                        <small class="text-secondary">Average Rating:</small>
                        <i class="fa-solid fa-star" style="color: #FFD43B;"></i>
                        <i class="fa-solid fa-star-half-stroke" style="color: #FFD43B;"></i> 
                      </p>
                    <% } %>

                    <% if (recMovie.vote_average >= 2.5 && recMovie.vote_average <= 2.9) { %>
                      <p class="mb-0 mt-3">
                        <small class="text-secondary">Average Rating:</small>
                          <i class="fa-solid fa-star" style="color: #FFD43B;"></i>
                          <i class="fa-solid fa-star" style="color: #FFD43B;"></i>
                      </p>
                    <% } %>


                    <% if (recMovie.vote_average >= 3.0 && recMovie.vote_average <= 3.4) { %>
                      <p class="mb-0 mt-3">
                        <small class="text-secondary">Average Rating:</small>
                          <i class="fa-solid fa-star" style="color: #FFD43B;"></i>
                          <i class="fa-solid fa-star-half-stroke" style="color: #FFD43B;"></i>
                      </p>
                    <% } %>

                    <% if (recMovie.vote_average >= 3.5 && recMovie.vote_average <= 3.9) { %>
                      <p class="mb-0 mt-3">
                        <small class="text-secondary">Average Rating:</small>
                        <i class="fa-solid fa-star" style="color: #FFD43B;"></i>
                        <i class="fa-solid fa-star" style="color: #FFD43B;"></i>
                        <i class="fa-solid fa-star" style="color: #FFD43B;"></i>
                      </p>
                    <% } %>

                    <% if (recMovie.vote_average >= 4.0 && recMovie.vote_average <= 4.4) { %>
                      <p class="mb-0 mt-3">
                        <small class="text-secondary">Average Rating:</small>
                        <i class="fa-solid fa-star" style="color: #FFD43B;"></i>
                        <i class="fa-solid fa-star" style="color: #FFD43B;"></i>
                        <i class="fa-solid fa-star" style="color: #FFD43B;"></i>
                        <i class="fa-solid fa-star-half-stroke" style="color: #FFD43B;"></i>
                      </p>
                    <% } %>

                    <% if (recMovie.vote_average >= 4.5 && recMovie.vote_average <= 4.9) { %>
                      <p class="mb-0 mt-3">
                        <small class="text-secondary">Average Rating:</small>
                        <i class="fa-solid fa-star" style="color: #FFD43B;"></i>
                        <i class="fa-solid fa-star" style="color: #FFD43B;"></i>
                        <i class="fa-solid fa-star" style="color: #FFD43B;"></i>
                        <i class="fa-solid fa-star" style="color: #FFD43B;"></i>
                      </p>
                    <% } %>

                    <% if( recMovie.vote_average >= 5.0) { %>
                      <p class="mb-0 mt-3">
                        <small class="text-secondary">Average Rating:</small>
                        <i class="fa-solid fa-star" style="color: #FFD43B;"></i>
                        <i class="fa-solid fa-star" style="color: #FFD43B;"></i>
                        <i class="fa-solid fa-star" style="color: #FFD43B;"></i>
                        <i class="fa-solid fa-star" style="color: #FFD43B;"></i>
                        <i class="fa-solid fa-star" style="color: #FFD43B;"></i>
                      </p>
                    <% } %>
                    <p class="mb-2"><small class="text-secondary">Release Date: <%= recMovie.release_date || "Unknown" %></small></p>
                    <a href="/movie/<%= recMovie.id %>" class="btn btn-primary">Read More</a>
                  </div>
                
                </div>
              </div>
          <% }) %>
        </div>
      </div>
  <% } %>
</body>
</html>
